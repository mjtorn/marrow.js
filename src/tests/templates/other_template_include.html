<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <script src="../../../lib/jquery-1.9.1.min.js" type="text/javascript"></script>
        <!-- <script src="http://code.jquery.com/jquery-1.9.1.min.js" type="text/javascript"></script> -->
        <script type="text/javascript">exports=window;</script>
        <script src="marrow.js" type="text/javascript"></script>
    </head>

    <body>
        <script id="incl" type="text/html">
            <ul>
                <li><a href="#">FIRST</a></li>
                <li data-foreachme-animals="animal">
                    <a href="#" data-bind="animal.name"></a>
                </li>
                <li><a href="#">LAST</a></li>
            </ul>
        </script>
        <div id="target">
            <div data-attr-id="content-id">
                <h1 data-bind="content-heading">This heading is replaced</h1>
            </div>
            <div id="incl-target">
                This is replaced
            </div>
        </div>
        <script type="text/javascript">
            $(function() {
                target = $('#target');
                incl = $('#incl');
                inclTarget = $('#incl-target');

                s = MRW.escapeStr(target.html());
                mrw = new MRW.Marrow(s);

                i = MRW.escapeStr(incl.html());
                iMrw = new MRW.Marrow(i);

                ctx = {
                    'content-id': 'fishlist',
                    'content-heading': 'fishes',
                    'animals': [
                        {'type': 'fish', 'name': 'trout'},
                        {'type': 'fish', 'name': 'flounder'},
                        {'type': 'fish', 'name': 'bass'},
                        {'type': 'fish', 'name': 'salmonella'},
                    ]
                }

                inclTarget.html(iMrw.renderString(ctx));
            });
        </script>
    </body>
</html>

